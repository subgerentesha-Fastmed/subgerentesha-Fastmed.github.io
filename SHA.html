<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Actividades SHA PROSALMED</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Fondo gris claro */
        }
        /* Barra de desplazamiento personalizada para una estética mejorada */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #3b82f6; /* Tailwind blue-500 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2563eb; /* Tailwind blue-600 */
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 sm:p-6 lg:p-8">

    <header class="w-full max-w-4xl bg-gradient-to-r from-blue-800 to-blue-600 text-white p-4 rounded-t-xl shadow-lg flex items-center justify-between mb-8">
        <div class="flex items-center space-x-4">
            <img src="https://ii.ct-stc.com/7/logos/empresas/2016/02/23/prosalmed-ca-2AB97E2384C27784thumbnail.jpeg" alt="Logo PROSALMED" class="h-16 w-36"> 
            <h1 class="text-xl sm:text-2xl font-bold">PROSALMED</h1>
        </div>
        <p class="text-sm sm:text-base font-light">Registro de Actividades</p>
    </header>

    <main class="w-full max-w-4xl bg-white p-6 sm:p-8 rounded-b-xl shadow-xl border-t-4 border-emerald-500 mb-8">
        <div id="messageBox" class="hidden text-center font-medium"></div>

        <section class="mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Registrar Nueva Jornada</h2>
            <form id="reportForm" class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                <div>
                    <label for="reportDate" class="block text-gray-700 text-sm font-semibold mb-2">Fecha:</label>
                    <input type="date" id="reportDate" name="reportDate"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                </div>

                <div>
                    <label for="coordinator" class="block text-gray-700 text-sm font-semibold mb-2">SHA Responsable:</label>
                    <input type="text" id="coordinator" name="coordinator" placeholder="Ej: Darwin Gómez"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                </div>

                <div>
                    <label for="location" class="block text-gray-700 text-sm font-semibold mb-2">Cliente:</label>
                    <select id="location" name="location" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 bg-white">
                        <option value="" disabled selected>Selecciona un cliente</option>
                        <option value="A&S CONSULTORES, C.A.">A&S CONSULTORES, C.A.</option>
                        <option value="ADMINISTRADORA 302, C.A.">ADMINISTRADORA 302, C.A.</option>
                        <option value="ASOCIACION VENEZOLANA DE LA IGLESIA DE JESUCRISTO DE LOS SANTOS DE LOS ULTIMOS DIAS">ASOCIACION VENEZOLANA DE LA IGLESIA DE JESUCRISTO DE LOS SANTOS DE LOS ULTIMOS DIAS</option>
                        <option value="BANCO ACTIVO, C.A.">BANCO ACTIVO, C.A.</option>
                        <option value="BAYER, S.A.">BAYER, S.A.</option>
                        <option value="CAMARA VENEZOLANO AMERICANA DE COMERCIO E INDUSTRIA (VENAMCHAM)">CAMARA VENEZOLANO AMERICANA DE COMERCIO E INDUSTRIA (VENAMCHAM)</option>
                        <option value="CARACAS SOUL C.A.">CARACAS SOUL C.A.</option>
                        <option value="CHOCOBRU INT.CHOCOLATE IMP. REG. CAP. C.A.">CHOCOBRU INT.CHOCOLATE IMP. REG. CAP. C.A.</option>
                        <option value="CONDOMINIO CENTRO COMERCIAL MERCADO DE LA CIUDAD">CONDOMINIO CENTRO COMERCIAL MERCADO DE LA CIUDAD</option>
                        <option value="CONSORCIO DE VALORES E INVERSIONES COVAIN, C.A.">CONSORCIO DE VALORES E INVERSIONES COVAIN, C.A.</option>
                        <option value="DESARROLLOS HOTELEROS LA CASTELLENA S.C.S.">DESARROLLOS HOTELEROS LA CASTELLENA S.C.S.</option>
                        <option value="DICAM SISTEMAS INTELIGENTES C.A.">DICAM SISTEMAS INTELIGENTES C.A.</option>
                        <option value="EAGLEBURGMANN VENEZUELA, C.A.">EAGLEBURGMANN VENEZUELA, C.A.</option>
                        <option value="GRUPO INFOGUIANET, C.A.">GRUPO INFOGUIANET, C.A.</option>
                        <option value="GRUPO INTEXUS C.A.">GRUPO INTEXUS C.A.</option>
                        <option value="H2 SERVICIO DE ALIMENTOS, C.A.">H2 SERVICIO DE ALIMENTOS, C.A.</option>
                        <option value="IMPORTADORA BICIMOTO LTDA C.A.">IMPORTADORA BICIMOTO LTDA C.A.</option>
                        <option value="INVERSIONES OTAPE C.A.">INVERSIONES OTAPE C.A.</option>
                        <option value="INVERSIONES QUIMIVECO 3, C.A.">INVERSIONES QUIMIVECO 3, C.A.</option>
                        <option value="INVERSORA MELKIM">INVERSORA MELKIM</option>
                        <option value="MASTERCARD VENEZUELA, INC.">MASTERCARD VENEZUELA, INC.</option>
                        <option value="OTAOLA INGENIERIA C.A.">OTAOLA INGENIERIA C.A.</option>
                        <option value="OXICORP, C.A.">OXICORP, C.A.</option>
                        <option value="PEPSICO (MARACAY)">PEPSICO (MARACAY)</option>
                        <option value="PROMOTORA 204 C.A.">PROMOTORA 204 C.A.</option>
                        <option value="PROSALMED C.A. CCCT">PROSALMED C.A. CCCT</option>
                        <option value="PROSALMED C.A. SBG">PROSALMED C.A. SBG</option>
                        <option value="PROSALMED C.A. SEDE PRINCIPAL">PROSALMED C.A. SEDE PRINCIPAL</option>
                        <option value="SNACKS (MARACAIBO)">SNACKS (MARACAIBO)</option>
                        <option value="SNACKS (MARACAY)">SNACKS (MARACAY)</option>
                        <option value="SNACKS (PTO ORDAZ)">SNACKS (PTO ORDAZ)</option>
                        <option value="SNACKS (VALENCIA)">SNACKS (VALENCIA)</option>
                        <option value="TELEFONICA">TELEFONICA</option>
                        <option value="VAN DER IMPORT, C.A.">VAN DER IMPORT, C.A.</option>
                        <option value="OTRO">OTRO</option>
                    </select>
                </div>

                <div>
                    <label for="startTime" class="block text-gray-700 text-sm font-semibold mb-2">Hora de Inicio:</label>
                    <input type="time" id="startTime" name="startTime"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                </div>

                <div>
                    <label for="endTime" class="block text-gray-700 text-sm font-semibold mb-2">Hora Fin:</label>
                    <input type="time" id="endTime" name="endTime"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                </div>

                <div class="md:col-span-2 text-center mt-2 p-3 bg-blue-50 rounded-lg text-blue-700 font-bold text-lg">
                    <span id="elapsedTimeDisplay">Tiempo Transcurrido: --</span>
                </div>

                <div class="md:col-span-2">
                    <label for="activities" class="block text-gray-700 text-sm font-semibold mb-2">Actividades Realizadas:</label>
                    <textarea id="activities" name="activities" rows="5"
                              class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"
                              placeholder="Describe las actividades realizadas, una por línea. Ej: 1.- Inspección de campo..."></textarea>
                </div>

                <div class="md:col-span-2">
                    <label for="observations" class="block text-gray-700 text-sm font-semibold mb-2">Observaciones:</label>
                    <textarea id="observations" name="observations" rows="3"
                              class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"
                              placeholder="Añade cualquier observación relevante. Ej: Durante la jornada laboral no se detectó..."></textarea>
                </div>

                <div class="md:col-span-2 flex flex-col sm:flex-row justify-center items-center gap-4 mt-6">
                    <button type="button" id="generateWhatsAppBtn" class="flex items-center justify-center space-x-2 w-full sm:w-auto bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V7a2 2 0 012-2h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V8z" /></svg>
                        <span>Enviar a WhatsApp</span>
                    </button>
                    <button type="button" id="copyReportBtn" class="flex items-center justify-center space-x-2 w-full sm:w-auto bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                        <span>Copiar Informe</span>
                    </button>
                    <button type="button" id="clearFormBtn" class="flex items-center justify-center space-x-2 w-full sm:w-auto bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-3 px-6 rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                        <span>Limpiar Formulario</span>
                    </button>
                </div>
            </form>
        </section>
    </main>

    <footer class="w-full max-w-4xl text-center text-gray-600 text-sm mt-8">
        &copy; 2025 PROSALMED SHA. Todos los derechos reservados.
    </footer>

<script>
    (function () {
        // --- CONSTANTES Y ELEMENTOS DEL DOM ---
        const form = document.getElementById('reportForm');
        const messageBox = document.getElementById('messageBox');
        const elapsedTimeDisplay = document.getElementById('elapsedTimeDisplay');
        const generateWhatsAppBtn = document.getElementById('generateWhatsAppBtn');
        const copyReportBtn = document.getElementById('copyReportBtn');
        const clearFormBtn = document.getElementById('clearFormBtn');

        // El código relacionado con los sliders ha sido eliminado
        
        const formInputs = {
            reportDate: document.getElementById('reportDate'),
            coordinator: document.getElementById('coordinator'),
            location: document.getElementById('location'),
            startTime: document.getElementById('startTime'),
            endTime: document.getElementById('endTime'),
            activities: document.getElementById('activities'),
            observations: document.getElementById('observations'),
        };
        const LOCAL_STORAGE_KEY = 'prosalmedShaReportData';

        // --- FUNCIONES AUXILIARES ---

        function displayMessage(message, type) {
            messageBox.textContent = message;
            messageBox.className = 'p-3 rounded-lg mb-4 text-center font-medium'; // Reset classes
            const typeClasses = {
                success: 'bg-green-100 text-green-800',
                error: 'bg-red-100 text-red-800',
                info: 'bg-blue-100 text-blue-800'
            };
            messageBox.classList.remove('hidden');
            messageBox.classList.add(...(typeClasses[type] || typeClasses.info).split(' '));
            setTimeout(() => { messageBox.classList.add('hidden'); }, 5000);
        }

        function calculateElapsedTime(startTimeStr, endTimeStr) {
            if (!startTimeStr || !endTimeStr) return '--';
            const [startHour, startMinute] = startTimeStr.split(':').map(Number);
            const [endHour, endMinute] = endTimeStr.split(':').map(Number);
            const startDate = new Date(2000, 0, 1, startHour, startMinute);
            let endDate = new Date(2000, 0, 1, endHour, endMinute);
            if (endDate < startDate) { endDate.setDate(endDate.getDate() + 1); }
            const diffMs = endDate.getTime() - startDate.getTime();
            const diffMinutes = Math.round(diffMs / (1000 * 60));
            const hours = Math.floor(diffMinutes / 60);
            const minutes = diffMinutes % 60;
            return `${hours} horas ${minutes} minutos`;
        }
        
        function formatTime(time) {
             if (!time) return '';
             const [h, m] = time.split(':');
             const date = new Date();
             date.setHours(h, m);
             return date.toLocaleTimeString('es-VE', { hour: '2-digit', minute: '2-digit', hour12: true });
        }


        function generateWhatsAppReport(reportData) {
            return `
*INFORME JORNADA SHA* ✅
---
🗓️ *FECHA:* ${reportData.reportDate}
⏰ *HORARIO:* ${reportData.startTime} - ${reportData.endTime}
⏳ *TIEMPO TRANSCURRIDO:* ${reportData.elapsedTime}
🧑‍💼 *SHA RESPONSABLE:* ${reportData.coordinator}
📍 *CLIENTE:* ${reportData.location}
---
*ACTIVIDADES REALIZADAS:* 📋
${reportData.activities}
---
*OBSERVACIONES:* 👁️
${reportData.observations}
---
¡Excelente jornada! 👍
`.trim();
        }

        // --- LÓGICA DE LA APLICACIÓN ---

        function getFormData() {
            const data = {
                reportDate: formInputs.reportDate.value,
                coordinator: formInputs.coordinator.value.trim(),
                location: formInputs.location.value,
                startTime: formInputs.startTime.value,
                endTime: formInputs.endTime.value,
                activities: formInputs.activities.value.trim(),
                observations: formInputs.observations.value.trim(),
            };
            const requiredFields = ['reportDate', 'location', 'startTime', 'endTime', 'activities', 'observations', 'coordinator'];
            const missingField = requiredFields.find(field => !data[field]);
            if (missingField) {
                displayMessage('Por favor, complete todos los campos requeridos para generar el informe.', 'error');
                return null;
            }

            data.elapsedTime = calculateElapsedTime(data.startTime, data.endTime);
            return data;
        }

        function updateElapsedTimeDisplay() {
            const startTime = formInputs.startTime.value;
            const endTime = formInputs.endTime.value;
            elapsedTimeDisplay.textContent = `Tiempo Transcurrido: ${calculateElapsedTime(startTime, endTime)}`;
        }

        function saveFormToLocalStorage() {
            const data = {
                reportDate: formInputs.reportDate.value,
                coordinator: formInputs.coordinator.value,
                location: formInputs.location.value,
                startTime: formInputs.startTime.value,
                endTime: formInputs.endTime.value,
                activities: formInputs.activities.value,
                observations: formInputs.observations.value,
            };
            localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(data));
        }

        function loadFormFromLocalStorage() {
            const savedData = localStorage.getItem(LOCAL_STORAGE_KEY);
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    Object.keys(data).forEach(key => {
                        if (formInputs[key]) { formInputs[key].value = data[key]; }
                    });
                    return true;
                } catch (e) {
                    console.error('Error al analizar datos de localStorage:', e);
                    localStorage.removeItem(LOCAL_STORAGE_KEY);
                    return false;
                }
            }
            return false;
        }
        
        function setDefaults() {
            form.reset();
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            formInputs.reportDate.value = `${year}-${month}-${day}`;
            updateElapsedTimeDisplay();
            saveFormToLocalStorage();
        }

        // --- INICIALIZACIÓN Y MANEJADORES DE EVENTOS ---
        function initialize() {
            if (!loadFormFromLocalStorage()) {
                setDefaults();
            }
            updateElapsedTimeDisplay();
            
            form.addEventListener('input', saveFormToLocalStorage);
            formInputs.startTime.addEventListener('change', updateElapsedTimeDisplay);
            formInputs.endTime.addEventListener('change', updateElapsedTimeDisplay);

            generateWhatsAppBtn.addEventListener('click', function () {
                const reportData = getFormData();
                if (!reportData) return;
                const formattedData = { ...reportData, startTime: formatTime(reportData.startTime), endTime: formatTime(reportData.endTime) };
                const whatsappText = generateWhatsAppReport(formattedData);
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(whatsappText)}`;
                window.open(whatsappUrl, '_blank');
                displayMessage('Reporte generado. Revisa tu aplicación de WhatsApp. 🎉', 'success');
            });

            copyReportBtn.addEventListener('click', function () {
                const reportData = getFormData();
                if (!reportData) return;
                const formattedData = { ...reportData, startTime: formatTime(reportData.startTime), endTime: formatTime(reportData.endTime) };
                const reportText = generateWhatsAppReport(formattedData);
                navigator.clipboard.writeText(reportText).then(() => {
                    displayMessage('Reporte copiado al portapapeles. ¡Listo para pegar! 📋', 'success');
                }).catch(err => {
                    console.error('Error al copiar:', err);
                    displayMessage('No se pudo copiar el informe.', 'error');
                });
            });

            clearFormBtn.addEventListener('click', function () {
                localStorage.removeItem(LOCAL_STORAGE_KEY);
                setDefaults();
                displayMessage('Formulario limpiado y listo para un nuevo registro.', 'info');
            });
        }

        initialize();
    })();
</script>
</body>
</html>